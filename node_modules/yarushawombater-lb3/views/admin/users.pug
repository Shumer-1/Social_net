extends ../layouts/main

block content
    div.header
        h1 Список пользователей
    button.add-user-btn#addUserBtn Добавить пользователя
    table
        thead
            tr
                th ФИО
                th Дата рождения
                th Email
                th Фотография
                th Роль
                th Статус
                th Действия
        tbody
            each user in users
                tr
                    td= user.fullName
                    td= user.birthDate
                    td= user.email
                    td
                        if user.photo
                            img(src=user.photo, alt=user.fullName, width="50")
                        else
                            | -
                    td= user.role
                    td= user.status
                    td
                        button.editUser(type="button", onclick=`window.location.href='/admin/users/${user.id}/edit'`) Редактировать
                        button.deleteUser(type="button", onclick=`confirmDeletion(${user.id})`) Удалить
                        button.viewFriends(type="button", onclick=`window.location.href='/admin/users/${user.id}/friends'`) Друзья
                        button.viewNews(type="button", onclick=`window.location.href='/admin/users/${user.id}/news'`) Новости друзей


    div#userDialog(title="Добавить пользователя", style="display:none;")
        form#userForm(method="POST", action="/admin/users", enctype="multipart/form-data")
            div
                label(for="fullName") ФИО:
                input#fullName(type="text", name="fullName", required)
            div
                label(for="birthDate") Дата рождения:
                input#birthDate(type="date", name="birthDate", required)
            div
                label(for="email") Email:
                input#email(type="email", name="email", required)
            div
                label(for="role") Роль:
                select#role(name="role")
                    option(value="user") Пользователь
                    option(value="admin") Администратор
            div
                label(for="status") Статус:
                select#status(name="status")
                    option(value="unconfirmed") Не подтверждённый
                    option(value="active") Активный
                    option(value="blocked") Заблокированный
            div
                label(for="photo") Фотография:
                input#photo(type="file", name="photo", accept="image/*")
            div
                button(type="submit") Сохранить
                button(type="button", onclick="closeDialog()") Отмена

    script.
        function confirmDeletion(userId) {
            if (confirm('Удалить пользователя?')) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = `/admin/users/${userId}?_method=DELETE`;
                document.body.appendChild(form);
                form.submit();
            }
        }
